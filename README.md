# Техническое задание

## Назначение
Разработать библиотеку на языке Go для преобразования файлов CSV в формат Parquet с поддержкой обработки очень больших файлов, которые не помещаются в оперативную память.

---

## Функциональные требования

1. **Язык реализации:** Go (Golang).
2. **Платформы:** Все операционные системы, на которых доступен компилятор Go (Linux, Windows, macOS и др.).
3. **Входные данные:**
   - CSV-файл, расположенный локально или в хранилище Amazon S3.
   - Возможность обработки файлов, размер которых превышает доступную оперативную память (streaming).
4. **Выходные данные:**
   - Parquet-файл, сохраняемый локально или в S3.
   - Поддержка всех типов данных, доступных в формате Parquet (BOOLEAN, INT32, INT64, FLOAT, DOUBLE, BYTE_ARRAY, FIXED_LEN_BYTE_ARRAY, DATE, TIME, TIMESTAMP, DECIMAL и др.).
   - Поддержка сжатия (Snappy, Gzip и другие, доступные в Parquet).
5. **Определение схемы данных:**
   - Два режима работы:
     1. Автоматическое определение схемы по данным CSV (детектор типов).
     2. Использование внешней схемы, предоставленной пользователем.
   - Формат описания схемы (пример в YAML):
     ```yaml
     columns:
       - name: id
         type: INT64
       - name: username
         type: BYTE_ARRAY
       - name: created_at
         type: TIMESTAMP
     ```
     Поддерживаются все типы, доступные в Parquet. Порядок колонок соответствует CSV.
6. **Обработка ошибок:**
   - Библиотека не ведёт логирование, но возвращает информативные ошибки с описанием причины сбоя.
7. **Производительность:**
   - Максимально возможная скорость обработки без ограничения по времени выполнения.

---

## Нефункциональные требования

1. **Потоковая обработка:**
   - Чтение и преобразование данных должно происходить по частям (batch/stream), чтобы не загружать весь файл в память.
2. **Интерфейс:**
   - Удобный API для интеграции в сторонние проекты на Go.
   - Возможность указания путей к файлам (локально или S3), схемы (опционально), типа сжатия (опционально).
3. **Зависимости:**
   - Использование только стабильных и поддерживаемых open-source библиотек для работы с Parquet и S3.
4. **Документация:**
   - README с примерами использования, описанием параметров и формата схемы.
5. **Тестирование:**
   - Покрытие основных сценариев unit-тестами (обработка больших файлов, разные типы данных, ошибки схемы, S3 и локальные файлы).

---

## Ограничения

- Не требуется поддержка пользовательских маппингов и фильтрации данных.
- Не требуется логирование внутри библиотеки.

---

## Пример использования (Go):
```go
err := csv2parquet.Convert(
    csv2parquet.Options{
        CsvPath: "s3://bucket/input.csv",
        ParquetPath: "output.parquet",
        SchemaPath: "schema.yaml", // опционально
        Compression: "snappy",     // опционально
    },
)
if err != nil {
    // обработка ошибки
}
```

---

## Пример схемы (YAML)
```yaml
columns:
  - name: id
    type: INT64
  - name: username
    type: BYTE_ARRAY
  - name: created_at
    type: TIMESTAMP
```

---

## Требования к качеству
- Чистый, читаемый и документированный код.
- Соответствие idiomatic Go.
- Легкость поддержки и расширения.